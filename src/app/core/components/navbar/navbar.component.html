<nav
    class="nav-glass fixed top-0 left-0 right-0 z-50 transition-all duration-300"
    role="navigation"
    aria-label="Main navigation"
    [class.nav-compact]="scrolled">

    <div class="container-responsive">
        <div class="nav-inner">

            <!-- Brand / Logo -->
            <div class="brand-container">
                <a routerLink="/home"
                    class="brand-link group"
                    aria-label="Go to home"
                    (click)="closeMobileMenu()">
                    <div class="logo-wrapper">
                        <img src="/images/GamerMajlis-removebg-preview.png"
                            alt="GamerMajlis logo"
                            class="logo-img">
                        <span class="logo-glow"></span>
                    </div>
                </a>
            </div>

            <!-- Desktop Navigation -->
            <div class="desktop-nav" aria-label="Primary navigation">
                @for (item of navItems; track item.path) {
                <a [routerLink]="item.path"
                    routerLinkActive="nav-active"
                    class="flex items-baseline rounded-3xl group px-4 py-2"
                    [attr.aria-label]="(item.label | translate)">
                    <i class="nav-icon fas me-2" [ngClass]="item.icon"></i>
                    <span class="nav-text-full">{{ item.label | translate
                        }}</span>
                    <span class="nav-text-short">{{ (item.label |
                        translate)?.slice(0, 4) }}</span>
                    <span class="pill-indicator"></span>
                </a>
                }
            </div>

            <!-- Right Actions -->
            <div class="actions-container">

                <!-- Desktop Messages & Language Toggle -->
                <div class="desktop-actions">
                    @if (isAuthenticated$) {
                    <a routerLink="/chatsPage"
                        class="action-chip"
                        aria-label="Messages">
                        <i class="fas fa-comments"></i>
                        <span class="action-text">{{ 'NAV.MESSAGES' | translate
                            }}</span>
                    </a>
                    }

                    <button (click)="language.toggleLanguage()"
                        class="icon-btn"
                        aria-label="Toggle language">
                        <i class="fas fa-globe"></i>
                    </button>
                </div>

                <!-- Profile Menu (Desktop & Tablet) -->
                @if (isAuthenticated$ && !isMobileView) {
                <div class="profile-container"
                    (mouseleave)="closeProfileMenu()"
                    (keyup.escape)="closeProfileMenu()">
                    <button (mouseenter)="profileOpen=true"
                        (click)="profileOpen=!profileOpen"
                        class="avatar-btn flex items-center"
                        aria-haspopup="menu"
                        [attr.aria-expanded]="profileOpen"
                        aria-label="Profile menu">
                        <img [src]="profilePictureUrl"
                            alt="User avatar"
                            class="avatar-img"
                            loading="lazy" />
                    </button>

                    @if (profileOpen) {
                    <div class="profile-menu" role="menu" @slideDown>
                        <div class="profile-header">
                            <p class="profile-name">{{ userData.user.displayName
                                }}</p>
                            <p class="profile-email">{{ userData.user.email
                                }}</p>
                        </div>
                        <div class="profile-links">
                            <a routerLink="/profile"
                                role="menuitem"
                                class="menu-item"
                                (click)="closeProfileMenu()">
                                <i class="fas fa-user"></i>
                                {{ 'NAV.PROFILE' | translate }}
                            </a>
                            <a routerLink="/wishlist"
                                role="menuitem"
                                class="menu-item"
                                (click)="closeProfileMenu()">
                                <i class="fas fa-heart text-red-600"></i>
                                {{ 'NAV.WISHLIST' | translate }}
                            </a>
                            <button (click)="logout()"
                                role="menuitem"
                                class="menu-item logout-btn">
                                <i class="fas fa-sign-out-alt"></i>
                                {{ 'NAV.LOGOUT' | translate }}
                            </button>
                        </div>
                    </div>
                    }
                </div>
                }

                <!-- Mobile Hamburger -->
                @if (isMobileView) {
                <button class="hamburger"
                    (click)="toggleMobileMenu()"
                    [attr.aria-expanded]="isMobileMenuOpen"
                    aria-label="Toggle mobile menu">
                    <span class="hamburger-line"
                        [class.open]="isMobileMenuOpen"></span>
                    <span class="sr-only">Toggle navigation</span>
                </button>
                }
            </div>
        </div>
    </div>
</nav>

<!-- Mobile Menu Overlay -->
@if (isMobileView && isMobileMenuOpen) {
<div class="mobile-overlay" @slideInLeft>
    <!-- Backdrop -->
    <div class="mobile-backdrop" (click)="closeMobileMenu()"></div>

    <!-- Mobile Drawer -->
    <aside class="mobile-drawer" role="dialog" aria-label="Mobile navigation">
        <div class="mobile-content">

            <!-- Mobile Header -->
            <div class="mobile-header">
                <a routerLink="/home"
                    class="mobile-brand"
                    (click)="closeMobileMenu()"
                    aria-label="Home">
                    <img src="/images/GamerMajlis-removebg-preview.png"
                        class="mobile-logo"
                        alt="GamerMajlis" />
                </a>
                <button class="mobile-close"
                    (click)="closeMobileMenu()"
                    aria-label="Close menu">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- Mobile Navigation -->
            <div class="mobile-nav">

                <!-- Search Bar -->
                <div class="mobile-search">
                    <input type="text"
                        placeholder="Search..."
                        class="search-input" />
                    <i class="search-icon fas fa-search"></i>
                </div>

                <!-- Navigation Links -->
                <div class="mobile-links">
                    @for (item of navItems; track item.path) {
                    <a [routerLink]="'/' + item.path"
                        (click)="closeMobileMenu()"
                        routerLinkActive="mobile-active"
                        class="mobile-link">
                        <i class="mobile-link-icon fas"
                            [ngClass]="item.icon"></i>
                        <span class="mobile-link-text">{{ item.label | translate
                            }}</span>
                    </a>
                    }
                </div>

                <!-- Mobile Actions -->
                @if (isAuthenticated$) {
                <div class="mobile-actions">
                    <a routerLink="/chatsPage"
                        (click)="closeMobileMenu()"
                        class="mobile-action">
                        <i class="fas fa-comments"></i>
                        <span>{{ 'NAV.MESSAGES' | translate }}</span>
                    </a>

                    <button (click)="language.toggleLanguage()"
                        class="mobile-action">
                        <i class="fas fa-globe"></i>
                        <span>{{ 'LANG.TOGGLE' | translate }}</span>
                    </button>

                    <a routerLink="/profile"
                        (click)="closeMobileMenu()"
                        class="mobile-action">
                        <i class="fas fa-user"></i>
                        <span>{{ 'NAV.PROFILE' | translate }}</span>
                    </a>
                </div>
                }
            </div>

            <!-- Mobile Footer -->
            @if (isAuthenticated$) {
            <div class="mobile-footer">
                <div class="mobile-user-info">
                    <img [src]="profilePictureUrl"
                        alt="User avatar"
                        class="mobile-avatar" />
                    <div class="mobile-user-details">
                        <p class="mobile-user-name">{{
                            userData.user.displayName }}</p>
                        <p class="mobile-user-email">{{ userData.user.email
                            }}</p>
                    </div>
                </div>
                <button (click)="logout()"
                    class="mobile-logout">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>{{ 'NAV.LOGOUT' | translate }}</span>
                </button>
            </div>
            }
        </div>
    </aside>
</div>
}

<!-- Navbar Spacer -->
<div class="navbar-spacer"></div>